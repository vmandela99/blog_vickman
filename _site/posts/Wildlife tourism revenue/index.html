<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Victor Mandela">
<meta name="dcterms.date" content="2024-11-06">

<title>Articles - The Growing Importance of Wildlife Economy: A Path to Sustainable Growth</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=GTM-T8DDSMN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'GTM-T8DDSMN', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../custom.scss">
<meta property="og:title" content="Articles - The Growing Importance of Wildlife Economy: A Path to Sustainable Growth">
<meta property="og:description" content="">
<meta property="og:image" content="Safari_pic.png">
<meta property="og:site_name" content="Articles">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Articles</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-my-courses" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">My Courses</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-my-courses">    
        <li>
    <a class="dropdown-item" href="../../courses/python.html">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/ruby.html">
 <span class="dropdown-text">Ruby</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../courses/SQL.html">
 <span class="dropdown-text">SQL</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../Projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Skills.html"> 
<span class="menu-text">Skills</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Templates and Resources.html"> 
<span class="menu-text">Templates and Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Case Study.html"> 
<span class="menu-text">Case Study</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About Vickman</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../contact/index.html"> 
<span class="menu-text">Contact</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vmandela99"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/vmandela99/" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:vmandela99@gmail.com"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://x.com/VictorMandela8"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.facebook.com/vmandela99"> <i class="bi bi-facebook" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.nature.com/articles/s41598-025-89030-z"> <i class="bi bi-briefcase" role="img">
</i> 
<span class="menu-text">Google Scholar</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Growing Importance of Wildlife Economy: A Path to Sustainable Growth</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Monitoring and Evaluation</div>
                <div class="quarto-category">Analysis</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Victor Mandela </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 6, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="the-growing-importance-of-wildlife-economy-a-path-to-sustainable-growth" class="level3">
<h3 class="anchored" data-anchor-id="the-growing-importance-of-wildlife-economy-a-path-to-sustainable-growth"><strong>The Growing Importance of Wildlife Economy: A Path to Sustainable Growth</strong></h3>
<p>The global wildlife economy plays a crucial role in fostering sustainable development, preserving biodiversity, and providing economic benefits to local communities. By closely monitoring metrics like <strong>biodiversity health</strong>, <strong>tourism revenue</strong>, and <strong>local employment in wildlife enterprises</strong>, stakeholders—governments, donors, and investors—can effectively support a balance between economic growth and conservation. This blog post breaks down the significance of these metrics and why they are essential in shaping policies and investment strategies for wildlife economies.</p>
<section id="understanding-the-metrics-that-matter" class="level4">
<h4 class="anchored" data-anchor-id="understanding-the-metrics-that-matter"><strong>Understanding the Metrics that Matter</strong></h4>
<p>In the context of the wildlife economy, three critical metrics stand out as indicators of both ecological and economic health:</p>
<p><img src="Cape Dwarf Chameleon II by Macky _ Redbubble.jpg" class="img-fluid"></p>
<ol type="1">
<li><p><strong>Biodiversity Health Index</strong><br>
This index provides insight into the status of wildlife populations and ecosystems. It tracks the number of species, their population trends, and conservation status. Understanding biodiversity health is essential to ensuring the long-term viability of wildlife tourism and related industries. If species are endangered or habitats are declining, the economic benefits from these activities will eventually diminish. This index helps determine the future sustainability of wildlife-based economies, guiding conservation policies and actions (FAO, 2020).</p>
<p><img src="22 Scarlet Macaw Facts_ Guide to the Beautiful Ara macao.jpg" class="img-fluid"></p></li>
<li><p><strong>Tourism Revenue from Wildlife-Based Activities</strong><br>
Wildlife tourism is a significant revenue source, especially for countries rich in biodiversity, such as Kenya, Tanzania, and Australia. The revenue generated from activities like safaris, ecotourism, and marine wildlife experiences helps local and national economies thrive. For instance, in 2023, <strong>Kenya</strong> and <strong>South Africa</strong> experienced a growth of up to <strong>25%</strong> in their wildlife tourism revenue, highlighting the importance of sustainable tourism in post-pandemic recovery. Monitoring tourism revenue is critical as it provides governments and investors with data to craft policies that support tourism infrastructure, promote conservation, and ensure long-term growth in the sector (WTTC, 2023).</p>
<p><img src="21 Fun &amp; Unique Things to Do in the Florida Keys.jpg" class="img-fluid"></p></li>
<li><p><strong>Local Community Employment and Income from Wildlife Enterprises</strong><br>
This metric assesses how wildlife enterprises contribute to the livelihoods of local communities. Activities like ecotourism, wildlife management, and conservation provide employment opportunities and generate income, especially in rural areas. The positive economic impacts from these activities are evident in countries like Uganda and Costa Rica, where ecotourism has seen significant growth, with revenue increases of <strong>15-20%</strong> from 2022 to 2023. For governments and donors, this metric underscores the role of wildlife enterprises in poverty alleviation and community development. Supporting these activities with funding and infrastructure can help lift communities out of poverty while promoting sustainable wildlife management practices (UNWTO, 2022).</p></li>
</ol>
</section>
<section id="the-2022-2023-revenue-shift-what-it-means" class="level4">
<h4 class="anchored" data-anchor-id="the-2022-2023-revenue-shift-what-it-means"><strong>The 2022-2023 Revenue Shift: What It Means</strong></h4>
<p>The wildlife tourism industry has shown remarkable resilience and growth in recent years, especially between 2022 and 2023. Countries heavily dependent on wildlife tourism, such as <strong>Kenya</strong>, <strong>South Africa</strong>, and <strong>Tanzania</strong>, experienced significant increases in revenue—ranging from <strong>$900M to $1.7B</strong>—as tourists returned post-pandemic. This surge demonstrates the sector’s potential to drive economic recovery and growth.</p>
<p>Here’s a breakdown of how the revenue shifted from 2022 to 2023 across a selection of countries:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 28%">
<col style="width: 28%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Country</th>
<th>2022 Revenue (USD)</th>
<th>2023 Revenue (USD)</th>
<th>Change (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kenya</strong></td>
<td>$1.2B</td>
<td>$1.5B</td>
<td>+25%</td>
</tr>
<tr class="even">
<td><strong>South Africa</strong></td>
<td>$900M</td>
<td>$1.1B</td>
<td>+22%</td>
</tr>
<tr class="odd">
<td><strong>Tanzania</strong></td>
<td>$750M</td>
<td>$900M</td>
<td>+20%</td>
</tr>
<tr class="even">
<td><strong>Australia</strong></td>
<td>$1.5B</td>
<td>$1.7B</td>
<td>+13%</td>
</tr>
<tr class="odd">
<td><strong>Mauritius</strong></td>
<td>$300M</td>
<td>$410M</td>
<td>+37%</td>
</tr>
<tr class="even">
<td><strong>Botswana</strong></td>
<td>$320M</td>
<td>$450M</td>
<td>+41%</td>
</tr>
</tbody>
</table>
<p><img src="Safari_pic.png" class="img-fluid"></p>
<p>This chart clearly shows the growing importance of wildlife tourism in global economies, particularly in African and island nations. Governments, donors, and investors should recognize the need to continue investing in conservation efforts, sustainable tourism infrastructure, and local community development to sustain this growth.</p>
</section>
<section id="implications-for-governments-donors-and-investors" class="level4">
<h4 class="anchored" data-anchor-id="implications-for-governments-donors-and-investors"><strong>Implications for Governments, Donors, and Investors</strong></h4>
<ol type="1">
<li><p><strong>For Governments</strong>:<br>
Governments should focus on creating policies that not only protect biodiversity but also ensure that the revenue generated from wildlife tourism is reinvested into conservation and local communities. Strengthening tourism infrastructure, offering incentives for sustainable practices, and implementing environmental protection laws are essential to maintaining the growth of this sector (World Bank, 2022).</p></li>
<li><p><strong>For Donors</strong>:<br>
Donors can contribute by funding community-based conservation programs, supporting sustainable wildlife tourism initiatives, and helping build local capacity. Their investments can help drive the inclusion of local communities in wildlife tourism, enhancing their participation in conservation efforts while simultaneously improving their livelihoods (Global Environment Facility, 2023).</p></li>
<li><p><strong>For Investors</strong>:<br>
Investors should recognize wildlife tourism as a profitable sector with significant growth potential. With revenue increases and demand for sustainable experiences on the rise, investors can explore opportunities in eco-resorts, wildlife conservation partnerships, and eco-tourism ventures. Strategic investments will ensure long-term returns while promoting conservation (International Finance Corporation, 2022).</p></li>
</ol>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion"><strong>Conclusion</strong></h4>
<p>The wildlife economy is a dynamic and critical sector for both biodiversity and economic development. By focusing on key metrics like biodiversity health, tourism revenue, and local community benefits, governments, donors, and investors can work together to promote sustainable growth that benefits both people and wildlife. As the sector continues to rebound post-pandemic, these efforts will ensure that wildlife economies thrive for generations to come.</p>
</section>
<section id="references-and-further-reading" class="level4">
<h4 class="anchored" data-anchor-id="references-and-further-reading"><strong>References and Further Reading</strong></h4>
<ul>
<li><p>FAO. (2020). <em>The State of World’s Biodiversity for Food and Agriculture</em>. Food and Agriculture Organization. <a href="https://www.fao.org/biodiversity/en/">Link to report</a>.</p></li>
<li><p>WTTC. (2023). <em>Economic Impact Report 2023</em>. World Travel and Tourism Council. <a href="https://wttc.org/Research/Economic-Impact">Link to report</a>.</p></li>
<li><p>UNWTO. (2022). <em>Tourism and Biodiversity Report</em>. United Nations World Tourism Organization. <a href="https://www.unwto.org/unwto-2022-a-year-review">Link to report.</a></p></li>
<li><p>World Bank. (2022). <em>Tourism for Sustainable Development</em>. <a href="https://www.worldbank.org/en/topic/tourism">Link to report</a>.</p></li>
<li><p>Global Environment Facility. (2023). <em>Funding Biodiversity Conservation Projects</em>. <a href="https://www.thegef.org/newsroom/press-releases/biodiversity-fund-approves-18-new-project-preparation-grants">Link to report.</a></p></li>
<li><p>International Finance Corporation. (2022). <em>Sustainable Investment in Tourism</em>. <a href="https://www.ifc.org/content/dam/ifc/doc/2023/IFC-AR22.pdf">Link to report.</a></p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>